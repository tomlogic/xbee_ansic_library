<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>XBee/ZigBee Driver: Server</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">XBee/ZigBee Driver
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Server<div class="ingroups"><a class="el" href="group__xbee.html">XBee Interface</a> &raquo; <a class="el" href="group__xbee__digi__data.html">Digi Data Endpoint</a> &raquo; <a class="el" href="group__pxbee__ota.html">Over-The-Air Firmware Update Cluster</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><pre class="fragment">     Code for the Programmable XBee to receive over-the-air firmware
     updates.</pre>  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:pxbee__ota__server_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pxbee__ota__server_8c.html">pxbee_ota_server.c</a></td></tr>
<tr class="memdesc:pxbee__ota__server_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Code to add an OTA Server Cluster to a device. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:pxbee__ota__server_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pxbee__ota__server_8h.html">pxbee_ota_server.h</a></td></tr>
<tr class="memdesc:pxbee__ota__server_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Code to add an OTA Server Cluster to a device. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gab44a801637b58555ff21ad96694f3bb2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pxbee__ota__server.html#gab44a801637b58555ff21ad96694f3bb2">PXBEE_OTA_CMD_SERVER_CLUST_ENTRY</a>(flag)</td></tr>
<tr class="memdesc:gab44a801637b58555ff21ad96694f3bb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macro to add the OTA cluster to the Digi Data Endpoint.  <a href="#gab44a801637b58555ff21ad96694f3bb2">More...</a><br /></td></tr>
<tr class="separator:gab44a801637b58555ff21ad96694f3bb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga91fd5b2f435dae3975df8c8586999f4f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pxbee__ota__server.html#ga91fd5b2f435dae3975df8c8586999f4f">pxbee_ota_server_cmd</a> (const <a class="el" href="structwpan__envelope__t.html">wpan_envelope_t</a> <a class="el" href="group__hal.html#gaef060b3456fdcc093a7210a762d5f2ed">FAR</a> *envelope, void <a class="el" href="group__hal.html#gaef060b3456fdcc093a7210a762d5f2ed">FAR</a> *context)</td></tr>
<tr class="memdesc:ga91fd5b2f435dae3975df8c8586999f4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cluster command to initiate firmware updates.  <a href="#ga91fd5b2f435dae3975df8c8586999f4f">More...</a><br /></td></tr>
<tr class="separator:ga91fd5b2f435dae3975df8c8586999f4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga38fdff5e9fec8c3aa8bfd167621ee35c"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pxbee__ota__server.html#ga38fdff5e9fec8c3aa8bfd167621ee35c">xbee_update_firmware_ota</a> (const <a class="el" href="structwpan__envelope__t.html">wpan_envelope_t</a> <a class="el" href="group__hal.html#gaef060b3456fdcc093a7210a762d5f2ed">FAR</a> *envelope, void <a class="el" href="group__hal.html#gaef060b3456fdcc093a7210a762d5f2ed">FAR</a> *context)</td></tr>
<tr class="memdesc:ga38fdff5e9fec8c3aa8bfd167621ee35c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Application needs to provide this function as a method of receiving firmware updates over-the-air with Xmodem protocol.  <a href="#ga38fdff5e9fec8c3aa8bfd167621ee35c">More...</a><br /></td></tr>
<tr class="separator:ga38fdff5e9fec8c3aa8bfd167621ee35c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<pre class="fragment">     Code for the Programmable XBee to receive over-the-air firmware
     updates.</pre> <h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="gab44a801637b58555ff21ad96694f3bb2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PXBEE_OTA_CMD_SERVER_CLUST_ENTRY</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">flag</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{  <a class="code" href="group__wpan__aps.html#gga1227ab13b41d82d9c9c9080662f74cf7aedb825ada66b8c7bbfbeaee6d9dfba0a">DIGI_CLUST_PROG_XBEE_OTA_UPD</a>, <a class="code" href="group__pxbee__ota__server.html#ga91fd5b2f435dae3975df8c8586999f4f">pxbee_ota_server_cmd</a>, NULL,         \</div><div class="line">      (flag) | <a class="code" href="group__wpan__aps.html#ga9e0a1a0abf5594d8fa5a38b1ca40b3bc">WPAN_CLUST_FLAG_SERVER</a> | <a class="code" href="group__wpan__aps.html#gacb0e365a8c5e72ee90be503513e7e630">WPAN_CLUST_FLAG_NOT_ZCL</a> }</div><div class="ttc" id="group__pxbee__ota__server_html_ga91fd5b2f435dae3975df8c8586999f4f"><div class="ttname"><a href="group__pxbee__ota__server.html#ga91fd5b2f435dae3975df8c8586999f4f">pxbee_ota_server_cmd</a></div><div class="ttdeci">int pxbee_ota_server_cmd(const wpan_envelope_t FAR *envelope, void FAR *context)</div><div class="ttdoc">Cluster command to initiate firmware updates. </div><div class="ttdef"><b>Definition:</b> pxbee_ota_server.c:30</div></div>
<div class="ttc" id="group__wpan__aps_html_gga1227ab13b41d82d9c9c9080662f74cf7aedb825ada66b8c7bbfbeaee6d9dfba0a"><div class="ttname"><a href="group__wpan__aps.html#gga1227ab13b41d82d9c9c9080662f74cf7aedb825ada66b8c7bbfbeaee6d9dfba0a">DIGI_CLUST_PROG_XBEE_OTA_UPD</a></div><div class="ttdoc">Start OTA update of PXBee App. </div><div class="ttdef"><b>Definition:</b> aps.h:141</div></div>
<div class="ttc" id="group__wpan__aps_html_ga9e0a1a0abf5594d8fa5a38b1ca40b3bc"><div class="ttname"><a href="group__wpan__aps.html#ga9e0a1a0abf5594d8fa5a38b1ca40b3bc">WPAN_CLUST_FLAG_SERVER</a></div><div class="ttdeci">#define WPAN_CLUST_FLAG_SERVER</div><div class="ttdoc">alias name for input cluster (uses ZCL terminology) </div><div class="ttdef"><b>Definition:</b> aps.h:230</div></div>
<div class="ttc" id="group__wpan__aps_html_gacb0e365a8c5e72ee90be503513e7e630"><div class="ttname"><a href="group__wpan__aps.html#gacb0e365a8c5e72ee90be503513e7e630">WPAN_CLUST_FLAG_NOT_ZCL</a></div><div class="ttdeci">#define WPAN_CLUST_FLAG_NOT_ZCL</div><div class="ttdoc">this cluster is NOT using the ZigBee Cluster Library (ZCL) </div><div class="ttdef"><b>Definition:</b> aps.h:244</div></div>
</div><!-- fragment -->
<p>Macro to add the OTA cluster to the Digi Data Endpoint. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">flag</td><td>set to WPAN_CLUST_FLAG_NONE or WPAN_CLUST_FLAG_ENCRYPT </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga91fd5b2f435dae3975df8c8586999f4f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pxbee_ota_server_cmd </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structwpan__envelope__t.html">wpan_envelope_t</a> <a class="el" href="group__hal.html#gaef060b3456fdcc093a7210a762d5f2ed">FAR</a> *&#160;</td>
          <td class="paramname"><em>envelope</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void <a class="el" href="group__hal.html#gaef060b3456fdcc093a7210a762d5f2ed">FAR</a> *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cluster command to initiate firmware updates. </p>
<p>Verifies that APS encryption was used (if cluster is configured as such) before handing off to implementation-provided function <a class="el" href="group__pxbee__ota__server.html#ga38fdff5e9fec8c3aa8bfd167621ee35c" title="Application needs to provide this function as a method of receiving firmware updates over-the-air wit...">xbee_update_firmware_ota()</a>.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__wpan__aps.html#ga8575b0db762a5fbb858d4994c9b657e3" title="General handler used in the cluster table. ">wpan_aps_handler_fn</a> </dd></dl>

<p>References <a class="el" href="group__hal.html#ga2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>, <a class="el" href="group__wpan__aps.html#ga1892eba2086d12ac2b09005aeb09ea3b">wpan_envelope_t::length</a>, <a class="el" href="group__wpan__aps.html#ga8737375e27cb391ff381fff10dc0c132">wpan_envelope_t::payload</a>, <a class="el" href="group__wpan__aps.html#ga1eafd87038a2134da7a1f72e6801d23b">WPAN_CLUST_FLAG_ENCRYPT</a>, <a class="el" href="group__wpan__aps.html#gaaaee02ff456d4f6103a5e94c2ba106c5">wpan_envelope_reply()</a>, <a class="el" href="group__wpan__aps.html#ga3bf12c3b9fd0afac2c9f58de8e7c38e9">WPAN_ENVELOPE_RX_APS_ENCRYPT</a>, <a class="el" href="group__wpan__aps.html#ga06f1e9e86b74ef807ded44b79b13e283">wpan_envelope_send()</a>, and <a class="el" href="group__pxbee__ota__server.html#ga38fdff5e9fec8c3aa8bfd167621ee35c">xbee_update_firmware_ota()</a>.</p>

</div>
</div>
<a class="anchor" id="ga38fdff5e9fec8c3aa8bfd167621ee35c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* xbee_update_firmware_ota </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structwpan__envelope__t.html">wpan_envelope_t</a> <a class="el" href="group__hal.html#gaef060b3456fdcc093a7210a762d5f2ed">FAR</a> *&#160;</td>
          <td class="paramname"><em>envelope</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void <a class="el" href="group__hal.html#gaef060b3456fdcc093a7210a762d5f2ed">FAR</a> *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Application needs to provide this function as a method of receiving firmware updates over-the-air with Xmodem protocol. </p>
<p>See <a class="el" href="pxbee__ota__client_8h.html" title="Support code for over-the-air (OTA) firmware updates of application code on Programmable XBee target...">xbee/pxbee_ota_client.h</a> for details on sending updates.</p>
<p>Your application can support password-protected updates by checking the payload of the request. If the payload is a valid request to initiate an update, this function should enter an "XMODEM receive" mode and start sending 'C' to the sender of the request, indicating that it should start sending 64-byte XMODEM packets with the new firmware.</p>
<p>On Digi's Programmable XBee platform, this function would exit to the bootloader so it can receive the new application firmware.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">envelope</td><td>command sent to start update &ndash; function may want to use the payload for some sort of password verification </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">context</td><td>user context (from cluster table)</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>do not respond to request </td></tr>
    <tr><td class="paramname">!NULL</td><td>respond to request with error message </td></tr>
  </table>
  </dd>
</dl>

<p>Referenced by <a class="el" href="group__pxbee__ota__server.html#ga91fd5b2f435dae3975df8c8586999f4f">pxbee_ota_server_cmd()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 22 2019 20:34:09 for XBee/ZigBee Driver by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
